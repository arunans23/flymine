# Base: 
@prefix :        <http://www.flymine.org/model/genomic#> .
@prefix rdfs:    <http://www.w3.org/2000/01/rdf-schema#> .
@prefix rdf:     <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix owl:     <http://www.w3.org/2002/07/owl#> .
@prefix xsd:     <http://www.w3.org/2001/XMLSchema#> .


# ---------------------------------------------------------------------------- #
#                      Core Object Model Elements                              #
# ---------------------------------------------------------------------------- #


# ------------ BioEntity is central class of schema ------------

# represents any biological entity in the object model
:BioEntity a owl:Class ;
    rdfs:subClassOf
      [ a owl:Restriction ;
        owl:maxCardinality "1" ;
        owl:onProperty :BioEntity__organism ] .

:BioEntity__identifier a owl:DatatypeProperty ;
    rdfs:domain :BioEntity ;
    rdfs:range xsd:string .

:BioEntity__synonyms a owl:ObjectProperty ;
    rdfs:domain :BioEntity ;
    rdfs:range :Synonym .

:BioEntity__annotations a owl:ObjectProperty ;
    owl:inverseOf :Annotation__subject .

:BioEntity__evidence a owl:ObjectProperty;
    rdfs:domain :BioEntity;
    rdfs:range :Evidence.

:BioEntity__organism a owl:ObjectProperty ;
    rdfs:domain :BioEntity ;
    rdfs:range :Organism .

:BioEntity__subjects a owl:ObjectProperty;
    owl:inverseOf :Relation__object .

:BioEntity__objects a owl:ObjectProperty;
    owl:inverseOf :Relation__subject .

# ------------ Annotation - a three-way cross between BioEntity, BioProperty, and Evidence ----------

:Annotation a owl:Class ;
    rdfs:subClassOf
      [ a owl:Restriction ;
        owl:maxCardinality "1" ;
        owl:onProperty :Annotation__subject ] ;
    rdfs:subClassOf
      [ a owl:Restriction ;
        owl:maxCardinality "1" ;
        owl:onProperty :Annotation__property ] .

:Annotation__qualifier a owl:DatatypeProperty ;
    rdfs:domain :Annotation;
    rdfs:range xsd:string .

:Annotation__subject a owl:ObjectProperty ;
    rdfs:domain :Annotation ;
    rdfs:range :BioEntity .

:Annotation__evidence a owl:ObjectProperty ;
    rdfs:domain :Annotation ;
    rdfs:range :Evidence .

:Annotation__property a owl:ObjectProperty ;
    rdfs:domain :Annotation ;
    rdfs:range :BioProperty .

# ------------ BioProperty represents any property of a BioEntity ------------

# any property applied to a BioEntity with associated evidence(s)

:BioProperty a owl:Class.

:BioProperty__annotations a owl:ObjectProperty ;
    owl:inverseOf :Annotation__property .

:BioProperty__evidence a owl:ObjectProperty ;
    rdfs:domain :BioProperty ;
    rdfs:range :Evidence .


# ------------ DAG Terms and relationships ---------------

:OntologyTerm a owl:Class ;
    rdfs:subClassOf :BioProperty .

:OntologyTerm__identifier a owl:DatatypeProperty ;
    rdfs:domain :OntologyTerm ;
    rdfs:range xsd:string .

:OntologyTerm__name a owl:DatatypeProperty ;
    rdfs:domain :OntologyTerm ;
    rdfs:range xsd:string .

:OntologyTerm__parentRelations a owl:ObjectProperty ;
    rdfs:domain :OntologyTerm ;
    rdfs:range :OntologyRelation .

:OntologyTerm__childRelations a owl:ObjectProperty ;
    rdfs:domain :OntologyTerm ;
    rdfs:range :OntologyRelation .

:OntologyRelation a owl:Class ;
    rdfs:subClassOf
      [ a owl:Restriction ;
        owl:maxCardinality "1" ;
        owl:onProperty :OntologyRelation__parentTerm ] ;
    rdfs:subClassOf
      [ a owl:Restriction ;
        owl:maxCardinality "1" ;
        owl:onProperty :OntologyRelation__childTerm ] .

:OntologyRelation__type a owl:DatatypeProperty ;
    rdfs:domain :OntologyRelation ;
    rdfs:range xsd:string .

:OntologyRelation__parentTerm a owl:ObjectProperty ;
    owl:inverseOf :OntologyTerm__childRelations .

:OntologyRelation__childTerm a owl:ObjectProperty ;
    owl:inverseOf :OntologyTerm__parentRelations .

# ------------ Relationships between BioEntity classes -----------

# define a common superclass for RankedRelation and Location and LinkedRelation
# has subject and object references to BioEntity

:Relation a owl:Class ;
    rdfs:subClassOf
      [ a owl:Restriction ;
        owl:maxCardinality "1" ;
        owl:onProperty :Relation__subject ] ;           
    rdfs:subClassOf
      [ a owl:Restriction ;
        owl:maxCardinality "1" ;
        owl:onProperty :Relation__object ] .

:Relation__subject a owl:ObjectProperty;
    rdfs:domain :Relation ;
    rdfs:range :BioEntity .

:Relation__object a owl:ObjectProperty;
    rdfs:domain :Relation ;
    rdfs:range :BioEntity .

:Relation__evidence a owl:ObjectProperty;
    rdfs:domain :Relation ;
    rdfs:range :Evidence .

# SimpleRelation relates two BioEntities with no specific information added

:SimpleRelation a owl:Class ;
    rdfs:subClassOf :Relation .

# RankedRelation describes an integer order (rank) for objects in subject

:RankedRelation a owl:Class ;
    rdfs:subClassOf :Relation .

:RankedRelation__rank a owl:DatatypeProperty ;
    rdfs:domain :RankedRelation ;
    rdfs:range xsd:integer .


# Location is a relation with start and end positions on another BioEntity

:Location a owl:Class ;
    rdfs:subClassOf :Relation .

:Location__start a owl:DatatypeProperty ;
    rdfs:domain :Location ;
    rdfs:range xsd:integer .

:Location__startIsPartial a owl:DatatypeProperty ;
    rdfs:domain :Location ;
    rdfs:range xsd:boolean .

:Location__end a owl:DatatypeProperty ;
    rdfs:domain :Location ;
    rdfs:range xsd:integer .      

:Location__endIsPartial a owl:DatatypeProperty ;
    rdfs:domain :Location ;
    rdfs:range xsd:boolean .

:Location__strand a owl:DatatypeProperty ;
    rdfs:domain :Location ;
    rdfs:range xsd:integer .

:Location__phase a owl:DatatypeProperty ;
    rdfs:domain :Location ;
    rdfs:range xsd:integer .

:Location__endPhase a owl:DatatypeProperty ;
    rdfs:domain :Location ;
    rdfs:range xsd:integer .


# PartialLocation is used where only part of a subject feature overlaps object feature
# additionally contains start and end in subject feature.

:PartialLocation a owl:Class ;
    rdfs:subClassOf :Location .

:PartialLocation__subjectStart a owl:DatatypeProperty ;
    rdfs:domain :PartialLocation ;
    rdfs:range xsd:integer .

:PartialLocation__subjectEnd a owl:DatatypeProperty ;
    rdfs:domain :PartialLocation ;
    rdfs:range xsd:integer .


# ------------- Evidence for properties etc. -----------#

:Evidence a owl:Class .

:Evidence__relations a owl:ObjectProperty ;
    owl:inverseOf :Relation__evidence .


# ------------ Synonyms link a BioEntity with name/id from an InfoSource ----------- #

:Synonym a owl:Class ;
    rdfs:subClassOf
      [ a owl:Restriction ;
        owl:maxCardinality "1" ;
        owl:onProperty :Synonym__subject ] ;
    rdfs:subClassOf
      [ a owl:Restriction ;
        owl:maxCardinality "1" ;
        owl:onProperty :Synonym__source ] .

:Synonym__subject a owl:ObjectProperty ;
    owl:inverseOf :BioEntity__synonyms .

:Synonym__source a owl:ObjectProperty ;
    rdfs:domain :Synonym ;
    rdfs:range :InfoSource .

:Synonym__value a owl:DatatypeProperty ;
    rdfs:domain :Synonym ;
    rdfs:range xsd:string .

:Synonym__type a owl:DatatypeProperty ;
    rdfs:domain :Synonym ;
    rdfs:range xsd:string .

:Comment a owl:Class;
    rdfs:subClassOf
      [ a owl:Restriction ;
        owl:maxCardinality "1" ;
        owl:onProperty :Comment__source ] ;
    rdfs:subClassOf
      [ a owl:Restriction ;
        owl:maxCardinality "1" ;
        owl:onProperty :Comment__subject ] .

:Comment__type a owl:DatatypeProperty;
    rdfs:domain :Comment;
    rdfs:range xsd:string.

:Comment__text a owl:DatatypeProperty;
    rdfs:domain :Comment;
    rdfs:range xsd:string.

# This subject field needs to point to a BioEntity object. This will need to be performed in code in the translator.
:Comment__subject a owl:ObjectProperty;
    rdfs:domain :Comment;
    rdfs:range :BioEntity.

:Comment__source a owl:ObjectProperty;
    rdfs:domain :Comment;
    rdfs:range :InfoSource.

# ----------- AnalysisResult is an outcome of some form of analysis ------------ #

:AnalysisResult a owl:Class ;
    rdfs:subClassOf :Evidence ;
    rdfs:subClassOf
      [ a owl:Restriction ;
        owl:maxCardinality "1" ;
        owl:onProperty :AnalysisResult__analysis ] ;
    rdfs:subClassOf
      [ a owl:Restriction ;
        owl:maxCardinality "1" ;
        owl:onProperty :AnalysisResult__source ] .

:AnalysisResult__confidence a owl:DatatypeProperty ;
    rdfs:domain :AnalysisResult ;
    rdfs:range xsd:float .

:AnalysisResult__analysis a owl:ObjectProperty ;
    rdfs:domain :AnalysisResult ;
    rdfs:range :Analysis .

:AnalysisResult__bioEntity a owl:ObjectProperty ;
    owl:inverseOf :BioEntity__analysisResults .

:AnalysisResult__source a owl:ObjectProperty;
    rdfs:domain :AnalysisResult;
    rdfs:range :InfoSource.

:ComputationalResult a owl:Class ;
    rdfs:subClassOf :AnalysisResult .

:ComputationalResult__score a owl:DatatypeProperty ;
    rdfs:domain :ComputationalResult ;
    rdfs:range xsd:double .

:ExperimentalResult a owl:Class ;
    rdfs:subClassOf :AnalysisResult .

:Analysis a owl:Class ;
    rdfs:subClassOf
      [ a owl:Restriction ;
        owl:maxCardinality "1" ;
        owl:onProperty :Analysis__publication ] .

:Analysis__publication a owl:ObjectProperty;
    rdfs:domain :Analysis;
    rdfs:range :Publication.


:ComputationalAnalysis a owl:Class ;
    rdfs:subClassOf :Analysis .

:ComputationalAnalysis__algorithm a owl:DatatypeProperty;
    rdfs:domain :ComputationalAnalysis;
    rdfs:range xsd:string.

:ComputationalAnalysis__description a owl:DatatypeProperty;
    rdfs:domain :ComputationalAnalysis;
    rdfs:range xsd:string.

:Experiment a owl:Class ;
    rdfs:subClassOf :Analysis .



# Define a common superclass for external info sources: databases and publications
:InfoSource a owl:Class ;
    rdfs:subClassOf :Evidence .

:InfoSource__title a owl:DatatypeProperty ;
    rdfs:domain :InfoSource ;
    rdfs:range xsd:string .

:Publication a owl:Class ;
    rdfs:subClassOf :InfoSource .

:Publication__authors a owl:ObjectProperty;
    rdfs:domain :Publication;
    rdfs:range :Author.

:Publication__journal  a owl:DatatypeProperty;
    rdfs:domain :Publication;
    rdfs:range xsd:string.

:Publication__volume a owl:DatatypeProperty;
    rdfs:domain :Publication;
    rdfs:range xsd:string.

:Publication__issue a owl:DatatypeProperty;
    rdfs:domain :Publication;
    rdfs:range xsd:string.

:Publication__year a owl:DatatypeProperty;
    rdfs:domain :Publication;
    rdfs:range xsd:integer.

:Publication__pages a owl:DatatypeProperty;
    rdfs:domain :Publication;
    rdfs:range xsd:string.

:Publication__pubMedId a owl:DatatypeProperty;
    rdfs:domain :Publication;
    rdfs:range xsd:string.

:Author a owl:Class.

:Author__name a owl:DatatypeProperty;
    rdfs:domain :Author;
    rdfs:range xsd:string.

:Author__publications a owl:ObjectProperty;
    rdfs:domain :Author ;
    rdfs:range :Publication .

:Database a owl:Class ;
    rdfs:subClassOf :InfoSource .

:Database__url a owl:DatatypeProperty;
    rdfs:domain :Database;
    rdfs:range xsd:string .

# Organism will map to a phylogeny when that data is available
:Organism a owl:Class .

:Organism__name a owl:DatatypeProperty;
    rdfs:domain :Organism;
    rdfs:range xsd:string.

:Organism__shortName a owl:DatatypeProperty;
    rdfs:domain :Organism;
    rdfs:range xsd:string.

:Organism__taxonId a owl:DatatypeProperty;
    rdfs:domain :Organism;
    rdfs:range xsd:integer.

:Organism__genus a owl:DatatypeProperty;
    rdfs:domain :Organism;
    rdfs:range xsd:string.

:Organism__species a owl:DatatypeProperty;
    rdfs:domain :Organism;
    rdfs:range xsd:string.

:Organism__abbreviation a owl:DatatypeProperty;
    rdfs:domain :Organism;
    rdfs:range xsd:string.
