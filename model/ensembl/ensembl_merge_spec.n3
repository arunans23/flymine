# Base: 
@prefix :        <http://www.flymine.org/model/genomic#> .
@prefix e:       <http://www.flymine.org/model/ensembl#> .
@prefix null:    <http://www.flymine.org/model/null#> .
@prefix rdfs:    <http://www.w3.org/2000/01/rdf-schema#> .
@prefix rdf:     <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix owl:     <http://www.w3.org/2002/07/owl#> .
@prefix xsd:     <http://www.w3.org/2001/XMLSchema#> .


# ---------------------------------------------------------------------------- #
#                      Sequence Ontology Elements                              #
# ---------------------------------------------------------------------------- #


:Exon a owl:Class ;
    rdfs:subClassOf :BioEntity ;
    owl:equivalentClass e:exon .

# position on contig moved to Location object
null:exon__contig_start a owl:DatatypeProperty ;
    owl:equivalentProperty e:exon__contig_start .

null:exon__contig_end a owl:DatatypeProperty ;
    owl:equivalentProperty e:exon__contig_end .

null:exon__contig_strand a owl:DatatypeProperty ;
    owl:equivalentProperty e:exon__contig_strand .

null:exon__phase a owl:DatatypeProperty ;
    owl:equivalentProperty e:exon__phase .

null:exon__end_phase a owl:DatatypeProperty ;
    owl:equivalentProperty e:exon__end_phase .

null:exon__sticky_rank a owl:DatatypeProperty ;
    owl:equivalentProperty e:exon__sticky_rank .

null:exon__contig a owl:ObjectProperty ;
    owl:equivalentProperty e:exon__contig .

# need exon_contig (reference) to becom Exon__contigs (a collection)
# must be done in EnsemblDataTranslator
:Exon__contigs a owl:ObjectProperty ;
    rdfs:domain :Exon ;
    rdfs:range :Contig .



# not all genes are named, those that are have name in xref table
# EnsemblTranslator will have to set this
:Gene a owl:Class ;
    rdfs:subClassOf :BioEntity ;
    owl:equivalentClass e:gene .

:Gene__name a owl:DatatypeProperty;
    rdfs:domain :Gene;
    rdfs:range xsd:string.

# e:gene__type is ensembl for all entries
null:gene__type a owl:DatatypeProperty ;
    owl:equivalentProperty e:gene__type .

null:gene__analysis a owl:ObjectProperty ;
    owl:equivalentProperty e:gene__analysis .

null:gene__transcript_count a owl:DatatypeProperty ;
    owl:equivalentProperty e:gene__transcript_count .

null:gene__display_xref a owl:DatatypeProperty ;
    owl:equivalentProperty e:gene__display_xref .

null:gene_description a owl:Class ;
    owl:equivalentClass e:gene_description .

# contig has reference to dna object, this becomes Sequence

:Contig a owl:Class ;
    rdfs:subClassOf :BioEntity ;
    owl:equivalentClass e:contig .

:Contig__identifier a owl:DatatypeProperty ;
    rdfs:subPropertyOf :BioEntity__identifier;
    rdfs:domain :Contig;
    rdfs:range xsd:string;
    owl:equivalentProperty e:contig__name.    

:Contig__sequence a owl:ObjectProperty ;
    rdfs:domain :Contig;
    rdfs:range :Sequence;
    rdfs:subPropertyOf :LocatedSequenceFeature__sequence;
    owl:equivalentProperty e:contig__dna .

# need to define here also
:LocatedSequenceFeature__sequence a owl:ObjectProperty;
    rdfs:domain :LocatedSequenceFeature;
    rdfs:range :Sequence.

null:contig__embl_offset a owl:DatatypeProperty ;
    owl:equivalentProperty e:contig__embl_offset .
    
 
# dna object -> Sequence
:Sequence a owl:Class;
    owl:equivalentClass e:dna.

null:dna__created a owl:DatatypeProperty;
    owl:equivalentProperty e:dna__created.

# EnsemblConverter needs to move embl_acc to :Synonym

:Clone a owl:Class ;
    rdfs:subClassOf :BioEntity ;
    owl:equivalentClass e:clone .

:Clone__identifier a owl:DatatypeProperty ;
    rdfs:subPropertyOf :BioEntity__identifier;
    rdfs:domain :Clone;
    rdfs:range xsd:string;
    owl:equivalentProperty e:clone__name.    


:Clone__htgPhase a owl:DatatypeProperty ;
    owl:equivalentProperty e:clone__htg_phase .

null:clone__embl_acc a owl:DatatypeProperty ;
    owl:equivalentProperty e:clone__embl_acc .

null:clone__version a owl:DatatypeProperty ;
    owl:equivalentProperty e:clone__version .

null:clone__embl_version a owl:DatatypeProperty ;
    owl:equivalentProperty e:clone__embl_version .

null:clone__created a owl:DatatypeProperty ;
    owl:equivalentProperty e:clone__created .

null:clone__modified a owl:DatatypeProperty ;
    owl:equivalentProperty e:clone__modified .


# ---------- repeat_feaure is a RepeatRegion -----------#

:RepeatRegion a owl:Class ;
    rdfs:subClassOf :BioEntity ;
    owl:equivalentClass e:repeat_feature .

# repeat_consensus to become part of RepeatRegion
null:repeat_consensus a owl:Class ;
    owl:equivalentClass e:repeat_consensus .

:RepeatRegion__start a owl:DatatypeProperty ;
    owl:equivalentProperty e:repeat_feature__repeat_start .

:RepeatRegion__end a owl:DatatypeProperty ;
    owl:equivalentProperty e:repeat_feature__repeat_end .

# fields that come from repeat_consensus need to be declared

:RepeatRegion__consensus a owl:DatatypeProperty ;
    rdfs:domain :RepeatRegion ;
    rdfs:range xsd:string .

:RepeatRegion__type a owl:DatatypeProperty ;
    rdfs:domain :RepeatRegion ;
    rdfs:range xsd:string .

null:repeat_feature__score a owl:DatatypeProperty ;
    owl:equivalentProperty e:repeat_feature__score .

null:repeat_feature__repeat_consensus a owl:ObjectProperty ;
    owl:equivalentProperty e:repeat_feature__repeat_consensus .

null:repeat_region__contig_start a owl:DatatypeProperty ;
    owl:equivalentProperty e:repeat_feature__contig_start .

null:repeat_region__contig_end a owl:DatatypeProperty ;
    owl:equivalentProperty e:repeat_feature__contig_end .

null:repeat_region__contig_strand a owl:DatatypeProperty ;
    owl:equivalentProperty e:repeat_feature__contig_strand .

null:repeat_region__analysis a owl:DatatypeProperty ;
    owl:equivalentProperty e:repeat_feature__analysis .

# ---------- assembly maps to null ---------- #
# Supercontig and associated locations created in EnsemblDataTranslator

:Supercontig a owl:Class;
    rdfs:subClassOf :BioEntity.

null:assembly a owl:Class ;
    owl:equivalentClass e:assembly .

# ------------ chromosome maps to Chromosome ------------ #

:Chromosome a owl:Class ;
    rdfs:subClassOf :BioEntity ;
    owl:equivalentClass e:chromosome .

:Chromosome__identifier a owl:DatatypeProperty ;
    rdfs:subPropertyOf :BioEntity__identifier;
    rdfs:domain :Chromosome;
    rdfs:range xsd:string;
    owl:equivalentProperty e:chromosome__name.    


# ------------ karyotype is a ChromosomeBand ----------- #

:ChromosomeBand a owl:Class ;
    rdfs:subClassOf :BioEntity ;
    owl:equivalentClass e:karyotype .

:ChromosomeBand__identifier a owl:DatatypeProperty ;
    rdfs:subPropertyOf :BioEntity__identifier ;
    rdfs:domain :ChromosomeBand ;
    rdfs:range xsd:string ;
    owl:equivalentProperty e:karyotype__band .

null:karyotype__chr_start a owl:DatatypeProperty ;
    owl:equivalentProperty e:karyotype__chr_start .

null:karyotype__chr_end a owl:DatatypeProperty ;
    owl:equivalentProperty e:karyotype__chr_end .


# ------------ exon_transcript is a RankedRelation ----------- #

:RankedRelation a owl:Class ;
    owl:equivalentClass e:exon_transcript .

:RankedRelation__subject a owl:ObjectProperty ;
    rdfs:domain :RankedRelation ;
    rdfs:range :BioEntity ;
    rdfs:subPropertyOf :Relation__subject ;
    owl:equivalentProperty e:exon_transcript__exon .

:RankedRelation__object a owl:ObjectProperty ;
    rdfs:domain :RankedRelation ;
    rdfs:range :BioEntity ;
    rdfs:subPropertyOf :Relation__object ;
    owl:equivalentProperty e:exon_transcript__transcript .


# ------------ transript is a Transcript ----------- #

:Transcript a owl:Class ;
    rdfs:subClassOf :BioEntity ;
    owl:equivalentClass e:transcript .

:Transcript__exonCount a owl:DatatypeProperty ;
    owl:equivalentProperty e:transcript__exon_count .

:Transcript__protein a owl:ObjectProperty;
    owl:equivalentProperty e:transcript__translation.

null:transcript__display_xref a owl:ObjectProperty ;
    owl:equivalentProperty e:transcript__display_xref .

# ----------- translation is a Protein ----------- #

:Protein a owl:Class ;
    rdfs:subClassOf :BioEntity ;
    owl:equivalentClass e:translation .

:Protein__translationStart a owl:DatatypeProperty ;
    owl:equivalentProperty e:translation__seq_start .

:Protein__translationEnd a owl:DatatypeProperty ;
    owl:equivalentProperty e:translation__seq_end .

:Protein__startExon a owl:ObjectProperty ;
    owl:equivalentProperty e:translation__start_exon .

:Protein__endExon a owl:ObjectProperty ;
    owl:equivalentProperty e:translation__end_exon .
   
# Protein inherits 'identifier' from BioEntity and has additional
# primaryAccession attribute

:Protein__primaryAccession a owl:DatatypeProperty;
    rdfs:domain :Protein;
    rdfs:range xsd:string.


# ----------- simple_feature maps to TRNA or CpGIsland --------- #

:TRNA a owl:Class ;
    rdfs:subClassOf :BioEntity ;
      rdfs:subClassOf e:simple_feature ;
      rdfs:subClassOf
        [ a owl:Restriction ;
           owl:onProperty e:simple_feature__analysis ;
           owl:hasValue
               [  rdfs:subClassOf e:analysis ;
                  rdfs:subClassOf
                      [ a owl:Restriction ;
                        owl:onProperty e:analysis__program ;
                        owl:hasValue "tRNAscan-SE"
                      ]
               ]
       ] ;
    rdfs:subClassOf
      [ a owl:Restriction ;
        owl:maxCardinality "1" ;
        owl:onProperty :TRNA__contig ] .

:TRNA__contig a owl:ObjectProperty;
    rdfs:domain :TRNA;
    rdfs:range :Contig.
# currently cannot have a src Resource equivalent to two tgt resources
#    owl:equivalentProperty e:simple_feature__contig.

null:simple_feature a owl:Class ;
    owl:equivalentClass e:simple_feature .

null:simple_feature__display_label a owl:DatatypeProperty ;
    owl:equivalentProperty e:simple_feature__display_label .

null:simple_feature__contig_start a owl:DatatypeProperty ;
    owl:equivalentProperty e:simple_feature__contig_start .

null:simple_feature__contig_end a owl:DatatypeProperty ;
    owl:equivalentProperty e:simple_feature__contig_end .

null:simple_feature__contig_strand a owl:DatatypeProperty ;
    owl:equivalentProperty e:simple_feature__contig_strand .

null:simple_feature__score a owl:DatatypeProperty ;
    owl:equivalentProperty e:simple_feature__score .

null:simple_feature__analysis a owl:DatatypeProperty ;
    owl:equivalentProperty e:simple_feature__analysis .


# ------------ dna_align_feature and protein_align_feature are Match objects ----------- #


null:dna_align_feature a owl:Class ;
    owl:equivalentClass e:dna_align_feature .

null:protein_align_feature a owl:Class ;
    owl:equivalentClass e:protein_align_feature .

null:supporting_feature a owl:Class ;
    owl:equivalentClass e:supporting_feature .

# ---------- currently we want to ignore protein_feature ----------- #

null:protein_feature a owl:Class ;
    owl:equivalentClass e:protein_feature .

# ---------- currently we want to ignore prediction_transcript ----------- #

null:prediction_transcript a owl:Class ;
    owl:equivalentClass e:prediction_transcript .

# ----------- ensembl xref section ------------ #

null:go_xref a owl:Class ;
    owl:equivalentClass e:go_xref .


null:external_db a owl:Class ;
    owl:equivalentClass e:external_db .

null:external_synonym a owl:Class ;
    owl:equivalentClass e:external_synonym .


null:object_xref a owl:Class ;
    owl:equivalentClass e:object_xref .


null:xref a owl:Class ;
    owl:equivalentClass e:xref .



# ----------- ensembl objects with no data or place in target mapped to null ------------ #

null:marker_synonym a owl:Class ;
    owl:equivalentClass e:marker_synonym .

null:marker_map_location a owl:Class ;
    owl:equivalentClass e:marker_map_location .

null:mapfrag a owl:Class ;
    owl:equivalentClass e:mapfrag .

null:marker_feature a owl:Class ;
    owl:equivalentClass e:marker_feature .

null:peptide_archive a owl:Class ;
    owl:equivalentClass e:peptide_archive .

null:marker a owl:Class ;
    owl:equivalentClass e:marker .

null:stable_id_event a owl:Class ;
    owl:equivalentClass e:stable_id_event .

null:qtl_feature a owl:Class ;
    owl:equivalentClass e:qtl_feature .

null:map a owl:Class ;
    owl:equivalentClass e:map .

null:mapannotationtype a owl:Class ;
    owl:equivalentClass e:mapannotationtype .

null:qtl a owl:Class ;
    owl:equivalentClass e:qtl .

null:gene_archive a owl:Class ;
    owl:equivalentClass e:gene_archive .

null:mapping_session a owl:Class ;
    owl:equivalentClass e:maping_session .

null:mapset a owl:Class ;
    owl:equivalentClass e:mapset .

null:mapannotation a owl:Class ;
    owl:equivalentClass e:mapannotation .

null:mapset a owl:Class ;
    owl:equivalentClass e:mapset .

null:meta a owl:Class ;
    owl:equivalentClass e:meta .

null:qtl_synonym a owl:Class ;
    owl:equivalentClass e:qtl_synonym .

null:map_density a owl:Class ;
    owl:equivalentClass e:map_density .

# ------------ e:analysis is a ComputationalAnalysis ------------ #

:ComputationalAnalysis a owl:Class ;
    owl:equivalentClass e:analysis .

:ComputationalAnalysis__algorithm a owl:DatatypeProperty ;
    owl:equivalentProperty e:analysis__logic_name .

null:analysis__created a owl:DatatypeProperty ;
    owl:equivalentProperty e:analysis__created .

null:analysis__logic_name a owl:DatatypeProperty ;
    owl:equivalentProperty e:analysis__program .

null:analysis__db a owl:DatatypeProperty ;
    owl:equivalentProperty e:analysis__db .

null:analysis__db_version a owl:DatatypeProperty ;
    owl:equivalentProperty e:analysis__db_version .

null:analysis__db_file a owl:DatatypeProperty ;
    owl:equivalentProperty e:analysis__db_file .

null:analysis__program_version a owl:DatatypeProperty ;
    owl:equivalentProperty e:analysis__program_version .

null:analysis__program_file a owl:DatatypeProperty ;
    owl:equivalentProperty e:analysis__program_file .

null:analysis__parameters a owl:DatatypeProperty ;
    owl:equivalentProperty e:analysis__parameters .

null:analysis__module a owl:DatatypeProperty ;
    owl:equivalentProperty e:analysis__module .

null:analysis__modele_version a owl:DatatypeProperty ;
    owl:equivalentProperty e:analysis__module_version .

null:analysis__gff_source a owl:DatatypeProperty ;
    owl:equivalentProperty e:analysis__gff_source .

null:analysis__gff_feature a owl:DatatypeProperty ;
    owl:equivalentProperty e:analysis__gff_feature .

null:identity_xref a owl:Class ;
    owl:equivalentClass e:identity_xref .


# ------------ xxx_stable_id maps to Synonym ----------- #

#  synonym, EnsemblTranslater will need to point this synonym at an InfoSource
:Synonym a owl:Class ;
    owl:equivalentClass e:exon_stable_id, e:gene_stable_id, e:translation_stable_id, e:transcript_stable_id .

:Synonym__value a owl:DatatypeProperty ;
    owl:equivalentProperty e:exon_stable_id__stable_id, e:gene_stable_id__stable_id, e:translation_stable_id__stable_id, e:transcript_stable_id__stable_id .

:Synonym__subject a owl:ObjectProperty ;
    owl:equivalentProperty e:exon_stable_id__exon, e:gene_stable_id__gene, e:translation_stable_id__translation, e:transcript_stable_id__transcript .

null:exon_stable_id__version a owl:DatatypeProperty ;
    owl:equivalentProperty e:exon_stable_id__version .

null:exon_stable_id__created a owl:DatatypeProperty ;
    owl:equivalentProperty e:exon_stable_id__created .

null:exon_stable_id__modified a owl:DatatypeProperty ;
    owl:equivalentProperty e:exon_stable_id__modified .

null:gene_stable_id__version a owl:DatatypeProperty ;
    owl:equivalentProperty e:gene_stable_id__version .

null:gene_stable_id__created a owl:DatatypeProperty ;
    owl:equivalentProperty e:gene_stable_id__created .

null:gene_stable_id__modified a owl:DatatypeProperty ;
    owl:equivalentProperty e:gene_stable_id__modified .

null:translation_stable_id__version a owl:DatatypeProperty ;
    owl:equivalentProperty e:translation_stable_id__version .

null:transcript_stable_id__version a owl:DatatypeProperty ;
    owl:equivalentProperty e:transcript_stable_id__version .


